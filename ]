var toggleLinks = document.querySelectorAll(".toggle-link");

toggleLinks.forEach(function(link) {
  link.addEventListener("click", function(event) {
    event.preventDefault();
    var historicalRentsDiv = link.parentElement.parentElement.querySelector(".historical-rents");
    var wasShowing = historicalRentsDiv.style.display == "block";

    if (wasShowing) {
      historicalRentsDiv.style.display = "none";
      link.innerText = "Show historical rents";
    } else {
      historicalRentsDiv.style.display = "block";
      link.innerText = "Hide historical rents";
    }

  });
});

var bedroomFilters = document.querySelectorAll(".beds-filter");

bedroomFilters.forEach(function(bedroomFilter) {
  var filters = bedroomFilters.querySelectorAll(".filter");

  filters.forEach(function(filter) {
    var buildingId = filter.id.match(/^\d/)[0];
    var beds = filter.id.match(/(\d)br/)[1];
    var buildingDiv = document.querySelector("#building_" + buildingId);
    var units = buildingDiv.querySelectorAll(".unit");
    var unitsWithBeds = [];

    units.forEach(function(unit) {
      if (unit.dataset.beds == beds) {
        unitsWithBeds.push(unit);
      }
    });

    if (unitsWithBeds.length > 0) {
      console.log("Building " + buildingId + "has " + unitsWithBeds.length + " " + beds + " bedrooms");
      filter.style.display = "block";
    }
  });
});
